---
title: win下通过修改host文件科学上网的原理和操作
date: 2017-09-22 12:10:08
categories: 计算机基础
tags:
---

# 井中的我们
## 什么是墙
[great firewall](https://baike.baidu.com/item/great%20firewall?fromenter=GFW&subLemmaId=987882 "墙的介绍")
中国特有的。就是国家对网络的封锁。想要看看外面的世界，就得翻墙。
![防火长城](greatwall.jpg "防火长城")
## 墙的原理
### 网络访问
我们访问网站都是通过网址进行访问的，比如www.google.com，但真实的网站其实是一个个ip，比如192.168.0.1这样，网址只是为了方便人们记忆查找，我们上网的时候，通过DNS服务器，把我们输入的网址解析成ip，返回给我们，然后我们通过这个ip访问网页。

举个例子吧，网址相当于一些电话号码的名词，比如火警电话，报警电话。而DNS服务器相当于查询台，我们想报警的时候，先打电话给查询台，问到报警电话，然后才能拨打报警电话得到我们想要的内容。当然，这个过程浏览器帮我们做好了，我们是不知道的。
### 不可逾越的墙
great firewall的原理就是在我们通过DNS查询ip的时候，防火长城将DNS污染，返回给我们一个错误的ip，这样我们就无法正常上网了，只能得到404 not found页面
![404 notfound](404.gif "令人厌烦的404")
用刚才的例子说，墙就是一个坏蛋，他干扰了查询台，我们本来想要的电话号码是110，他干扰后返回给我们250，我们自然打不通电话。
## 关于中国互联网和我们要翻墙的原因
### 中国互联网
网络审查在各个国家都普遍存在着，它并不仅存在于中国。在全球的局势对中国都不利的当下，当局会过滤掉影响、危害到中国长远发展的信息，此时国家安全的意义更加重大。

互联网上存在着大量终究不现实的、不客观的，甚至自相矛盾的抹黑当局政府言论，它们背后一般有西方政府或非政府组织资金支持。这些媒体包括但不限于一些港媒、境外网站。

我们在遇到此类言论和见解时，不要不加思考地、情绪一度被煽动而不能克制地、盲目地相信这些片面或者歪曲事实的东西，而是要事实求是地思考，要摆脱情绪绑架的怪诞思维去理解。

我们需要了解到，中国的发展总基调是“稳中求进”，中国社会的最核心问题就是稳定。失去稳定的中国将会是一盘散沙，面临分裂和肢解的危险。我们希望您了解当今中国发展的根本保证是什么，发展的过程中哪部分是主旋律，哪些是噪音；哪些是进取的，哪些是会开历史倒车的。我们需要维新，而不是革命。

我们应该清醒和全面地认识问题，偏信西方媒体的言论、缺乏对国家的信任是不可取的。您的数据安全和隐私对您尤为重要。若这些信息不应当被西方掌握时，它对国家和民族的命运更为重要。出于此原因，当局可能会限制您的行为，我们不会也无法干预当局的任何政策和决定。
### 翻墙的原因
被墙的网站和资源数量很多，内容五花八门：有政治敏感的，有涉及色情赌博的，有涉及违法犯罪的。除此之外，其实还有很多网站是对程序员非常有帮助的网站，比如：

Google：作为世界第一大搜索引擎，Google在中国打不开不知让多少人崩溃。作为程序员，搜索最新的科技进展、学习最新的编程语言、解决编程中的各种问题，Google都是最好的帮手之一。GFW封锁Google，真是不应该。

YouTube：第一大视频网站，上面有无数免费的科技教程、讲座。想要学习编程语言和最新技术，YouTube上往往能找到很多视频。因为上YouTube需要消耗大量流量，所以必须靠谱的翻墙工具才能顶用，比如好用的VPN或者Shadowsocks，大家常用的免费VPN往往不够用。

Twitter：科技圈、编程圈儿的世界级大佬们大部分都有推特账号，他们会随时发表最新的信息和观点，价值十分可观。可惜，上Twitter也必须翻墙。

Github：如果不翻墙，使用git会很慢，有时github也会呗墙

# 使用VPN翻墙和使用hosts翻墙的基本原理
## 使用VPN翻墙
首先了解两个概念
### VPN
[VPN](https://baike.baidu.com/item/%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91%E7%BB%9C/8747869?fr=aladdin&fromid=382304&fromtitle=VPN)，中文翻译为虚拟专业网络，英文全称是Virtual Private Network。现在VPN被普遍定义为通过一个公用互联网络建立一个临时的、安全的连接，是一条穿过混乱的公用网络的安全、稳定隧道，使用这条隧道可以对数据进行几倍加密达到安全使用互联网的目的，广泛使用企业办公当中。简单的说，VPN就是为了大家在互联网连接和使用中，开辟一条临时的通道，最大程度保证传输数据的便捷以及安全性。

看不懂？那就简单理解为一条不怕墙的网络同路
### 代理服务器
代理（英语：Proxy），也称网络代理，是一种特殊的网络服务，允许一个网络终端（一般为客户端）通过这个服务与另一个网络终端（一般为服务器）进行非直接的连接。一些网关、路由器等网络设备具备网络代理功能。一般认为代理服务有利于保障网络终端的隐私或安全，防止攻击。

提供代理服务的电脑系统或其它类型的网络终端称为[代理服务器](https://www.baidu.com/link?url=9cie9N6oskxGRb6hMELtJdO9QqWnqWfiHnpp5P5jZ4skKMJ19P8xQl1xlz_T-uiPu4t-GI_9T1ItU4rKCgJMUHSMgPw10dLq3IuPpyF_ShBYhQb22EjY44udQ2Bniftl9czJ-2Y4X7xn35Ww71IA5a&wd=&eqid=8ecba41b0000c46e0000000459c4b056)

也看不懂？那就理解为一个不受墙的干扰，代替你获取信息的服务器。
## VPN翻墙原理
现在你应该可以想象翻墙的原理了吧
 ![vpn翻墙原理](images.jpg "vpn翻墙原理")
既然我们的电脑被墙了，那么我们就通过一个在国外，不受墙干扰的服务器，代替DNS，得到我们想访问网站的ip和有关信息，这就是vpn翻墙的原理。

还是用打电话的例子，既然我访问查询台会被干扰，那就让一个在国外的小伙伴帮我查询，再告诉我电话，这样就ok了。
## hosts翻墙原理
当然，还有一个方法，就是修改hosts文件翻墙，Hosts 文件本来是用来提高解析效率。在进行 DNS 请求以前，系统会先检查自己的 Hosts 文件中是否有这个地址映射关系，如果有则调用这个 IP 地址映射，如果没有再向已知的 DNS 服务器提出域名解析。也就是说 Hosts 的请求级别比 DNS 高。当你的 Hosts 文件里面有对应的 IP 时，它就会直接访问那个 IP，而不用通过 DNS。所以，当我们直接将 Google、Twitter、Facebook 之类的 IP 放入 Hosts 文件后，就可以跳过 DNS 的解析这一步，直接就行 IP 访问，不受 GFW 的 DNS 污染干扰了。

emmm我们继续打电话，hosts文件就相当于我们的电话簿，我们在向电话台查询之前会翻翻我们的电话簿，如果电话簿有我们想要的电话，那就不用查询电话台了，直接拨打就是了
![](jizhi.jpg)
## hosts翻墙的问题
### hosts文件需要更新
事实上很多网站的ip都是经常更换的，为了正常翻墙，我们的hosts文件也要经常更新。
### 翻墙能力有限
虽然通过修改hosts文件翻墙会比通过vpn翻墙要快，但是，它只能解决墙对DNS服务器的污染，有些时候会失去效用，所以如果想要稳定翻墙，还是需要vpn。
# 修改hosts文件翻墙的操作

## 找到hosts的文件位置
我的电脑->C:\Windows\System32\drivers\etc。hosts 文件是一个没有后缀名的文件。然后用最新hosts文件替换它
## 下载最新的hosts文件并替换原来的hosts
下面是两个一直更新的hosts文件获取地址
[从老D的博客上下载](https://laod.cn/hosts/2017-google-hosts.html)
[github开源项目](https://github.com/racaljk/hosts)
## 最后刷新DNS缓存
我的电脑是 Windows 10 ，使用快捷键 Win + R ，通过 CMD 进入命令行，输入以下命令即可刷新 DNS：
>ipconfig /flushdns

emmm这就可以科学上网了，就是这么简单

引用: 
https://www.zhihu.com/question/19782572
https://laod.cn/hosts/2017-google-hosts.html